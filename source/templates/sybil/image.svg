<svg xmlns="http://www.w3.org/2000/svg" width="800" height="<%= 48
  + (!!base.header)*62
  + (!!base.metadata)*108
  + (!!base.activity)*108
  + (!!base.community)*94
  + (!!base.repositories)*142
  + ((!!base.repositories)*(!!computed.plugins.traffic))*18
  + ((!!base.repositories)*(!!computed.plugins.followup))*102
  + ((!!base.repositories)*(!!computed.plugins.lines))*34
  + (!!computed.plugins.pagespeed)*110
  + (!!computed.plugins.languages)*124
  + Math.max(0, (((!!base.metadata)+(!!base.header)+((!!base.activity)||(!!base.community))+(!!base.repositories)+(!!computed.plugins.pagespeed)+(!!computed.plugins.languages))-1))*20
%>">
  <%
    meta.$ = `<span class="ps1-path">${`${user.login}`.toLocaleLowerCase()}@metrics</span>:<span class="ps1-location">~</span>${computed.token.scopes.includes("repo") ? "#" : "$"}`
    meta.animations = !meta.placeholder ? {stdin:.16, stdout:.28, length:(2+Object.keys(base).length+Object.keys(computed.plugins).length)} : {stdin:0, stdout:0, length:0}
  %>

  <defs><style><%= fonts %></style></defs>

  <style>
    <%= style %>
  </style>

  <style>
  svg {
    background-color: rgba(0,0,0,.2);
  }
  </style>

  <foreignObject x="0" y="0" width="100%" height="100%">
    <div xmlns="http://www.w3.org/1999/xhtml" xmlns:xlink="http://www.w3.org/1999/xlink">

      <div class="panel-a">
      
        <svg version="1.0" width="485" height="295" viewBox="0 0 970 590" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient gradientUnits="userSpaceOnUse" x1="626.954" y1="106.507" x2="626.954" y2="600.825" id="gradient-0" spreadMethod="pad" gradientTransform="matrix(1, 0, 0, 1, -252.223952, -69.962656)">
              <stop offset="0" style="stop-color: rgb(39, 39, 39);"></stop>
              <stop offset="1" style="stop-color: rgb(120, 120, 120);"></stop>
            </linearGradient>
          </defs>
          <polygon style="stroke: rgb(0, 0, 0); fill-opacity: 0.7;" points="91.712 554.506 118.055 580.559 426.536 579.515 464.575 541.37 915.889 542.762 954.875 504.473 954.179 447.387 923.199 415.507 923.171 294.917 954.719 266.017 954.179 125.889 941.648 125.889 942.344 258.858 911.016 288.745 911.712 402.948 940.951 434.971 941.3 490.53 904.402 527.079 451.473 526.383 414.073 564.672 106.217 565.901 104.364 563.767"></polygon>
          <polygon style="stroke-width: 5px; stroke: rgb(255, 255, 255); fill: url(#gradient-0); paint-order: fill; fill-opacity: 0.8;" points="60.702 212.856 90.069 183.856 90.436 131.729 153.943 71.893 564.105 71.526 616.232 123.653 940.423 122.919 941.524 260.945 911.423 289.19 911.79 404.049 940.423 433.049 941.524 490.335 902.613 528.513 450.521 527.299 412.344 565.11 105.313 565.844 60.161 521.793"></polygon>
          <polygon style="stroke-width: 4px; fill-opacity: 0.7;" points="930.265 312.416 968.284 276.567 968.439 299.794 930.573 336.429"></polygon>
          <polygon style="fill: rgb(255, 255, 255);" points="16.887 51.164 37.508 19.468 281.526 18.705 302.53 51.546 542.348 52.31 552.658 62.239 27.961 61.093"></polygon>
          <polygon style="stroke: rgb(255, 255, 255); stroke-width: 4px; fill: url(#gradient-0); fill-opacity: 0.8;" points="921.531 297.533 959.55 261.684 959.705 284.911 921.839 321.546"></polygon>
          <polygon style="fill: rgb(255, 255, 255);" points="122.796 119.381 139.702 119.381 178.141 80.062 162.213 80.005"></polygon>
          <line style="stroke-width: 3px; fill: none; stroke: rgb(255, 255, 255);" x1="158.144" y1="116.641" x2="589.916" y2="116.843"></line>
        </svg>

        <div class="initialization">
          <div class="text">
            INITIALIZATION<span class="s1">/</span><span class="s2">/</span>
          </div>
          <div class="loader">
            <% for (let i = 0; i < 4; i++) { %> 
              <svg width="63" height="54" viewBox="0 0 56 46" xmlns="http://www.w3.org/2000/svg">
                <polygon style="fill: rgb(255, 255, 255); fill-opacity: 0.7;" points="6.091 5.408 43.878 5.408 50.359 11.522 50.369 32.734 44.067 39.923 11.423 39.656 5.873 34.268"></polygon>
                <line style="stroke: rgb(255, 255, 255);" x1="22.967"  y1="0.907" x2="0.574" y2="0.956"></line>
                <line style="stroke: rgb(255, 255, 255);" x1="1.077" y1="0.785" x2="1.077" y2="36.615"></line>
                <line style="stroke: rgb(255, 255, 255);" x1="0.923" y1="36.27" x2="9.8" y2="45.08"></line>
                <line style="stroke: rgb(255, 255, 255);" x1="9.477" y1="44.948" x2="22.844" y2="45.053"></line>
                <line style="stroke: rgb(255, 255, 255);" x1="35.132" y1="45.109" x2="46.228" y2="45.147"></line>
                <line style="stroke: rgb(255, 255, 255);" x1="45.839" y1="45.316" x2="55.009" y2="34.691"></line>
                <line style="stroke: rgb(255, 255, 255);" x1="54.884" y1="35.025" x2="55.006" y2="9.59"></line>
                <line style="stroke: rgb(255, 255, 255);" x1="55.155" y1="9.932" x2="45.441" y2="0.792"></line>
                <line style="stroke: rgb(255, 255, 255);" x1="45.757" y1="0.923" x2="34.971" y2="0.854"></line>
              </svg>
            <% } %>
          </div>
        </div>


        <div class="text">
          <div class="name">
            <%= user.name %>
          </div>
          <div class="fields">
            <div class="column">
              <div class="field">
                <div class="name">Pull requests</div>
                <div class="value"><%= user.contributionsCollection.totalPullRequestReviewContributions %> reviewed, <%= user.contributionsCollection.totalPullRequestContributions %> opened</div>
              </div>
              <div class="field">
                <div class="name">Issues</div>
                <div class="value"><%= user.contributionsCollection.totalIssueContributions %> opened, <%= user.issueComments.totalCount %> comment<%= s(user.issueComments.totalCount) %></div>
              </div>
            </div>

            <div class="column">
              <div class="field">
                <div class="name">Pull requests</div>
                <div class="value"><%= user.contributionsCollection.totalPullRequestReviewContributions %> reviewed, <%= user.contributionsCollection.totalPullRequestContributions %> opened</div>
              </div>
              <div class="field">
                <div class="name">Issues</div>
                <div class="value"><%= user.contributionsCollection.totalIssueContributions %> opened, <%= user.issueComments.totalCount %> comment<%= s(user.issueComments.totalCount) %></div>
              </div>
            </div>

          </div>
        </div>

      </div>

      <div class="panel-b">
        
          <svg version="1.0" width="387" height="360" viewBox="0 0 775.000000 520.000000" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient gradientUnits="userSpaceOnUse" x1="626.954" y1="106.507" x2="626.954" y2="600.825" id="gradient-0" spreadMethod="pad" gradientTransform="matrix(1, 0, 0, 1, -181.178146, -103.229454)">
                <stop offset="0" style="stop-color: rgb(39, 39, 39);"></stop>
                <stop offset="1" style="stop-color: rgb(120, 120, 120);"></stop>
              </linearGradient>
            </defs>
            <polygon style="fill-opacity: 0.7;" points="36.646 486.258 62.989 512.311 371.47 511.267 409.509 473.122 713.907 472.488 769.067 425.888 768.292 57.345 750.943 57.68 752.996 418.229 702.417 459.338 396.407 458.135 359.007 496.424 51.151 497.653 49.298 495.519"></polygon>
            <polygon style="stroke-width: 5px; stroke: rgb(40, 142, 148); fill: url(#gradient-0); paint-order: fill; fill-opacity: 0.8;" points="5.636 144.608 35.003 115.608 35.37 63.481 98.877 3.645 509.039 3.278 561.166 55.405 751.612 54.671 752.719 419.047 702.654 459.252 395.455 459.051 357.278 496.862 50.247 497.596 5.095 453.545"></polygon>
            <polygon style="fill: rgb(40, 142, 148);" points="67.73 51.133 84.636 51.133 123.075 11.814 107.147 11.757"></polygon>
            <line style="stroke-width: 3px; fill: none; stroke: rgb(40, 142, 148);" x1="103.078" y1="48.393" x2="534.85" y2="48.595"></line>
          </svg>

          <img class="avatar" src="data:image/png;base64,<%= computed.avatar %>" width="90" height="90" />

          <div class="header">
            ID-CTRL: <%= user.databaseId %>
          </div>

          <div class="text">
            <div class="name">
              <%= user.name %>
            </div>
            <div class="field">
              Joined GitHub <%= computed.registration %>
            </div>
            <div class="field">
              Followed by <%= user.followers.totalCount %> user<%= s(user.followers.totalCount) %>
            </div>
            <div class="field">
              Contributed to <%= user.repositoriesContributedTo.totalCount %> repositor<%= s(user.repositoriesContributedTo.totalCount, "y") %>
            </div>

            <div class="field calendar">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 <%= computed.calendar.length*15 %> 11" width="<%= computed.calendar.length*15 %>" height="16">
                <g>
                  <% for (const [x, {color}] of Object.entries(computed.calendar)) { %>
                    <rect class="day" x="<%= x*15 %>" y="0" width="11" height="11" fill="<%= color %>" rx="2" ry="2" />
                  <% } %>
                </g>
              </svg>
            </div>

          </div>
      </div>

      <div class="panel-c">
            
        <svg width="160" height="160" viewBox="0 0 140 140" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <radialGradient gradientUnits="userSpaceOnUse" cx="87.934" cy="79.591" r="57.771" id="gradient-0" gradientTransform="matrix(1, 0, 0, 1, -22.690545, -6.201027)">
              <stop offset="0" style="stop-color: rgba(216, 216, 216, 1)"></stop>
              <stop offset="1" style="stop-color: rgba(165, 165, 165, 1)"></stop>
            </radialGradient>
            <mask id="mask">
              <circle style="fill: rgb(255, 255, 255);" cx="70.558" cy="70.29" r="64.003"></circle>
            </mask>
          </defs>
          <g mask="url(#mask)">
            <circle style="stroke: rgb(255, 255, 255); stroke-width: 3px; fill: none;" cx="70.558" cy="70.29" r="64.003"></circle>
            <circle style="fill: url(#gradient-0); fill-opacity: 0.7;" cx="65.243" cy="73.39" r="57.771"></circle>
            <circle class="hue" style="fill: none; stroke: rgb(186, 218, 85); stroke-width: 22px; stroke-dasharray: 16;" cx="-46.032" cy="143.29" r="116.707"></circle>
          </g>
        </svg>

        <div class="text">
          <div class="field">
            <div class="name">Commits</div>
            <div class="commits value"><%= computed.commits %><div>
          </div>
        </div>

      </div>


    </div>
  </foreignObject>
</svg>

